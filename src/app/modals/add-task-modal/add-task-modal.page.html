
<ion-content padding class='myModal'>
    <ion-grid>
        <ion-row>
            <ion-col text-center>
                Add new task
            </ion-col>
        </ion-row>
        
        
        <ion-row>
            <ion-segment [(ngModel)]="taskTabs" size='start'>
                <ion-segment-button value="general" >
                    <ion-label>General</ion-label>
                    <ion-icon name='clipboard'></ion-icon>
                </ion-segment-button>
                
                <ion-segment-button value="docs" disabled>
                    <ion-label>Documents</ion-label>
                    <ion-icon name="attach"></ion-icon>
                </ion-segment-button>
            </ion-segment>
            
        </ion-row>
        
        <div [ngSwitch]="taskTabs">
            <div *ngSwitchCase="'general'" >
                <form [formGroup]="taskForm">
                    
                    <ion-row>
                        <ion-col text-center>
                            <ion-label color="primary">Task Title*</ion-label>
                            <ion-input  type='Text' formControlName="title"  placeholder='My new Task'></ion-input>
                        </ion-col>
                    </ion-row>
                    
                    <ion-row>
                        <ion-col>
                            <ion-label>Asigned User*:</ion-label>
                            <ion-select placeholder="Asigned User" formControlName="assignedUserId" > 
                                <ion-select-option *ngFor="let user of simpleUsers|async;" [value]="user.id"  (ionChange)="setUser(user.id)"> {{user.lastName}} {{user.firstName}}</ion-select-option>
                            </ion-select>
                            <ion-button size='small' color="primary">Me: <ion-checkbox checked id="meCheck" [(ngModel)]='me' (ionChange)="getProfile()" [ngModelOptions]="{standalone: true}"></ion-checkbox></ion-button>
                        </ion-col>
                    </ion-row>
                    
                    
                    
                    
                    <ion-row>
                        <ion-col>
                            <ion-label>Client*:</ion-label>
                            <ion-select  formControlName="clientId" placeholder="Client"> 
                                <ion-select-option *ngFor="let client of clients|async;" [value]="client.id" (ionChange)="setClient(client.id)">{{client.name}}</ion-select-option>
                            </ion-select>
                        </ion-col>
                    </ion-row>
                    
                    
                    <ion-row>
                        <ion-col>
                            <ion-label>Description:</ion-label>
                            <ion-textarea formControlName="description" [(ngModel)]="description" placeholder='Enter a description'></ion-textarea>  
                        </ion-col>
                    </ion-row>
                    
                    <ion-input type='text' hidden  value="{{description}}" formControlName="descriptionHtml"></ion-input>
                    
                    
                    
                    <div formGroupName="entityRelatedTo">     
                        <ion-input type='text' hidden [(ngModel)]="entityId" formControlName="entityId"></ion-input>
                        <ion-input  type='text'  hidden [(ngModel)]="entityType" formControlName="entityType"></ion-input>
                    </div>
                    
                    <div>
                        <ion-item>
                            <ion-label>Deadline*:</ion-label>
                            <ion-select required placeholder="Select a date" [(ngModel)]='select' [ngModelOptions]="{standalone: true}" (ionChange)="checkDate()" >
                                <ion-select-option value="immediately" >Immediately</ion-select-option>
                                <ion-select-option value="forYouInfomation">For your infomation</ion-select-option>
                                <ion-select-option value="enableOn">On</ion-select-option>
                                <ion-select-option value="enableFrom">To</ion-select-option>
                            </ion-select>
                        </ion-item>
                        
                        <div [hidden]="!showFrom == true">
                            <ion-label>From:</ion-label>
                            <ion-datetime displayFormat="MMM/DD/YYYY HH:mm" max="2100-12-31" (ionChange)='setFrom()' placeholder="Pick a date" [(ngModel)]="fromDate" [ngModelOptions]="{standalone: true}"></ion-datetime>
                        </div>
                        
                        <div [hidden]="!showTo == true">
                            <ion-label>To:</ion-label>
                            <ion-datetime displayFormat="MMM/DD/YYYY HH:mm" max="2100-12-31" (ionChange)='setTo()' placeholder="Pick a date" [(ngModel)]="toDate" [ngModelOptions]="{standalone: true}"></ion-datetime>
                        </div>
                    </div>
                    
                    <ion-row>
                        <ion-col text-center>
                            <ion-button color="warning" (click)="closeModal()"> <ion-icon name="close-circle"> </ion-icon> </ion-button>
                            <ion-button color="secondary"  (click)="addTask()"><ion-icon name="save"></ion-icon> </ion-button>                  
                        </ion-col>
                    </ion-row>
                    
                </form>
            </div>
            <div *ngSwitchCase="'docs'" >
                    Documents
            </div>
        </div>
    </ion-grid>
    
</ion-content>
